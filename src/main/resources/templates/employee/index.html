<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Employee Management</title>
    <head th:insert="~{fragments/fragment::html_head}"></head>
</head>
<body>
<header th:replace="~{fragments/header :: header}"></header>
<div class="container">
    <div class="d-flex justify-content-between align-items-center my-4">
        <h2>Employees</h2>
        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#employeeModal">Add Employee</button>
    </div>

    <table class="table table-bordered">
        <thead>
        <tr>
            <th>ID</th>
            <th>Full Name</th>
            <th>Image</th>
            <th>Level</th>
            <th>Department</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="employee : ${employeePage.content}">
            <td th:text="${employee.id}"></td>
            <td th:text="${employee.fullName}"></td>
            <td>
                <img th:if="${employee.image}" th:src="${employee.image}" alt="Image" style="width:50px;height:50px;">
            </td>
            <td th:text="${employee.level}"></td>
            <td th:text="${employee.department != null ? employee.department.name : 'N/A'}"></td>
            <td>
                <a th:href="@{/employees/view/{id}(id=${employee.id})}" class="btn btn-info">View</a>
                <a th:href="@{/employees/edit/{id}(id=${employee.id})}" class="btn btn-warning">Edit</a>
                <form th:action="@{/employees/delete/{id}(id=${employee.id})}" method="post" style="display:inline;">
                    <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure?')">Delete</button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>

    <nav>
        <ul class="pagination justify-content-center">
            <li class="page-item" th:classappend="${employeePage.hasPrevious() ? '' : 'disabled'}">
                <a class="page-link" th:href="@{/employees(page=${employeePage.number - 1}, size=${employeePage.size})}">Previous</a>
            </li>
            <li class="page-item disabled">
                <span class="page-link" th:text="${employeePage.number + 1}"></span>
            </li>
            <li class="page-item" th:classappend="${employeePage.hasNext() ? '' : 'disabled'}">
                <a class="page-link" th:href="@{/employees(page=${employeePage.number + 1}, size=${employeePage.size})}">Next</a>
            </li>
        </ul>
    </nav>
</div>

<div class="modal fade" id="employeeModal" tabindex="-1" aria-labelledby="employeeModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form th:action="@{/employees/create}" method="post" enctype="multipart/form-data">
                <div class="modal-header">
                    <h5 class="modal-title" id="employeeModalLabel">Add Employee</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="fullName" class="form-label">Full Name</label>
                        <input type="text" name="fullName" class="form-control" id="fullName" required>
                    </div>

                    <div class="mb-3">
                        <label for="gender" class="form-label">Gender</label>
                        <select name="gender" class="form-control" id="gender" required>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label for="birthDate" class="form-label">Birthdate</label>
                        <input type="date" name="birthDate" class="form-control" id="birthDate" required>
                    </div>

                    <div class="mb-3">
                        <label for="salary" class="form-label">Salary</label>
                        <input type="number" name="salary" class="form-control" id="salary" required>
                    </div>

                    <div class="mb-3">
                        <label for="level" class="form-label">Level</label>
                        <input type="number" name="level" class="form-control" id="level" min="1" max="10" required>
                    </div>

                    <div class="mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" name="email" class="form-control" id="email" required>
                    </div>

                    <div class="mb-3">
                        <label for="phone" class="form-label">Phone</label>
                        <input type="text" name="phone" class="form-control" id="phone" required pattern="^09[0-9]{8}$">
                    </div>

                    <div class="mb-3">
                        <label for="department" class="form-label">Department</label>
                        <select name="department" class="form-control" id="department">
                            <option th:each="department : ${departments}" th:value="${department.id}" th:text="${department.name}"></option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label for="notes" class="form-label">Notes</label>
                        <textarea name="notes" class="form-control" id="notes"></textarea>
                    </div>

                    <div class="mb-3">
                        <label for="image" class="form-label">Image</label>
                        <input type="file" name="image" class="form-control" id="image">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>
</div>

<footer th:replace="~{fragments/footer :: footer}"></footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
